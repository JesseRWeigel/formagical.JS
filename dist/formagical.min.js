/*! Fomagical - v1.3.0 - 2014-05-04
* http://www.codeorelse.nl
* Copyright (c) 2014 Siebe Hiemstra; Licensed MIT */(function(){jQuery(function(){return $.formagical=function(a,b){var c;return c="",this.settings={},this.$element=$(a),this.mostRecentFocusedElement=null,this.lastInteractionTime=0,this.startTime=0,this.submitted=!1,this.setState=function(a){return c=a},this.getState=function(){return c},this.getLastInteractionTime=function(){return lastInteractionTime},this.setLastInteractionTime=function(a){a=a},this.getMostRecentFocusedElement=function(){return mostRecentFocusedElement},this.setMostRecentFocusedElement=function(a){mostRecentFocusedElement=a},this.getSetting=function(a){return this.settings[a]},this.trackInAnalytics=function(a,b,c,d){var e="<strong>"+a+"</strong><small> had interaction </small><strong>"+b+"</strong>";("undefined"!=typeof c||0==c)&&(e+=" <small>after</small> <strong>"+(c/1024).toFixed(2)+" seconds</strong> "),"undefined"!=typeof d&&(e+=" <small>and changed </small> <strong>"+d+"</strong>"),$("#messages ul").prepend('<li class="list-group-item alert alert-success">'+e+"</li>"),console.log(a,b,c,d)},this.callSettingFunction=function(a,b){return null==b&&(b=[]),this.settings[a].apply(this,b)},this.init=function(){this.settings=$.extend({},this.defaults,b);var a=this,c=new Date,d=c.getTime();if(this.startTime=d,a.settings.track.call(a,$(a.$element).attr("name"),"ready for awesome stats"),"undefined"==typeof _gaq)throw new Error("Add GA to your page.");return this.$element.find("input, textarea, select").not("[type=checkbox],[type=submit]").each(function(){var b=$(this).attr("name");if("undefined"==typeof b||""==b)throw new Error("Every form element should have a name");$(this).blur(function(){var c=new Date,d=c.getTime(),e=$(this).val(),f=$(this).data("valueBeforeFocus"),g="from "+(""==f?"nothing":f)+" to "+e,h=e==f?" nothing":g;a.settings.track.call(a,b,"focusOut",d-$(this).data("startFocus"),h)}),$(this).keydown(function(){{var c=new Date,d=c.getTime();$(this).val(),$(this).data("valueBeforeFocus")}if(!$(this).data("userStartedTypingInThisBox")){var e="Started typing";a.settings.track.call(a,b,e,d-$(this).data("userStartedFocusingAt")),$(this).data("userStartedTypingInThisBox",!0)}{var f=this,g=1500;$(f).val()}console.log(d,$(f).data("lastTimeTypingInThisBox")),d-$(f).data("lastTimeTypingInThisBox")>g&&a.settings.track.call(a,b,"paused and continued ",d-$(this).data("lastTimeTypingInThisBox")),$(f).data("lastTimeTypingInThisBox",d),$(this).data("valueBeforeFocus",$(this).val())}),$(this).focus(function(){var c=new Date,d=c.getTime();$(this).data("userStartedTypingInThisBox",!1),$(this).data("userStartedFocusingAt",d),$(this).data("lastTimeTypingInThisBox",d),a.setMostRecentFocusedElement(b),$(this).data("startFocus",d),$(this).data("valueBeforeFocus",$(this).val()),a.settings.track.call(a,b,"focus")})}),this.$element.bind("submit",function(){var b=($(this).attr("name"),new Date),c=b.getTime();return a.submitted=!0,a.settings.track.call(a,"form","submitted",c-a.startTime),!1}),this.$element.find("input[type=checkbox]").each(function(){var b=$(this).attr("name");$(this).bind("change",function(){var c=new Date,d=(c.getTime(),$(this).prop("checked")),e=!d,f="from "+(""===e?"nothing":e)+" to "+d,g=d==e?" has not changed":f;a.settings.track.call(a,b,"changed",void 0,g),$(this).data("valueBeforeFocus",$(this).prop("checked")),a.setMostRecentFocusedElement(b)})}),this.$element.find("select").each(function(){$(this).bind("change",function(){var b=$(this).attr("name"),c=new Date,d=c.getTime();if($(this).data("lastTimeSelectionTime"))var e=$(this).data("lastTimeSelectionTime")?d-$(this).data("lastTimeSelectionTime"):0;else var e=$(this).data("startFocus")?d-$(this).data("startFocus"):0;var f=$(this).val(),g=$(this).data("valueBeforeFocus"),h="from "+(""===g?"nothing":g)+" to "+f,i=f==g?" has not changed":h;a.settings.track.call(a,b,"changed",e,i),$(this).data("valueBeforeFocus",$(this).val()),$(this).data("lastTimeSelectionTime",d),a.setMostRecentFocusedElement(b)})}),$(window).bind("beforeunload",function(){var b=a.getMostRecentFocusedElement(),c=new Date,d=c.getTime();return a.settings.track.call(a,b,"user leaves",d-a.startTime),a.submitted?void 0:"Je doet nog niet mee voor de grote prijs. Waarom ga je dan weg? Please stay."}),this.setState("ready")},this.init(),this},$.formagical.prototype.defaults={message:"Hello world",track:function(a,b,c,d){return this.trackInAnalytics(a,b,c,d)}},$.fn.formagical=function(a){return this.each(function(){var b;return void 0===$(this).data("formagical")?(b=new $.formagical(this,a),$(this).data("formagical",b)):void 0})}})}).call(this);